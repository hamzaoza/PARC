"use strict";var PAD={};PAD.Data={},PAD.Options={bgColor:40402,skyColor:16767128,hotspotColor:16763395,fog:!0,minDistance:30,maxDistance:80,minPolarAngle:25,maxPolarAngle:55,showLights:!1},PAD.Data.Global={geometry:[{name:"WorldFloor",geometry:new THREE.PlaneBufferGeometry(256,256,1,1),position:[0,0,0],rotation:[-90,0,0]}],sceneLights:[{type:"Ambient",intensity:.5},{type:"Hemisphere",sky:PAD.Options.skyColor,ground:PAD.Options.bgColor,intensity:.5},{type:"Point",color:14644633,position:[1.9,7.5,-5],shadow:!0,intensity:.2},{type:"Point",color:11725047,position:[1.9,20,5.1],shadow:!0,intensity:.3},{type:"Point",color:14644633,position:[1.9,7.5,20],shadow:!0,intensity:.2},{type:"Point",color:14644633,position:[1.9,7.5,-15],shadow:!0,intensity:.2}]},PAD.Data.Site3={models:[{name:"floor",path:"assets/models/site3/site3-floor.json"},{name:"layout",path:"assets/models/site3/site3-layout.json"}],hotspots:[{name:"handwash",position:[8.24,3,21.6],data:{type:"image",url:"https://placekitten.com/1920/1080",caption:"Hello World!"}},{name:"touchscreen",position:[6.5,3,14.34],data:{type:"video",url:"https://player.vimeo.com/video/87651855"}},{name:"waiting-costa",position:[13.92,3,13.74],data:{type:"image",url:"https://placekitten.com/1920/1080",caption:"Hello World!"}},{name:"waiting-bench",position:[11.48,3,2.66],data:{type:"image",url:"https://placekitten.com/1920/1080",caption:"Hello World!"}},{name:"waiting-corner",position:[9.78,3,1.24],data:{type:"image",url:"https://placekitten.com/1920/1080",caption:"Hello World!"}},{name:"toilets",position:[22.38,6,3.18],data:{type:"video",url:"https://www.youtube.com/embed/MbDzrNM5qYg"}},{name:"spiro",position:[-.32,3,23.06],data:{type:"text",title:"Pulmonary Function",description:"So in spirometry you will blow into the machine and they will put a new mouthpiece on so that it’s completely hygienic…you’re touching equipment and you’re going to touch things, naturally door handles, so they squirt some hand sanitizer in your hand and you rub that in…"}},{name:"monday",position:[-8.58,6,6.96],data:{type:"text",title:"Monday Clinic",description:"Different days of the week and different spaces for different bacterial ‘cohorts’",floor:"assets/textures/site3/site3-floor.mp4"}}]},PAD.Data.Pavilion={models:[{name:"floor",path:"assets/models/pavilion/pavilion-floor.json",scale:[.7,.7,.7]},{name:"beds",path:"assets/models/pavilion/pavilion-beds.json",scale:[.7,.7,.7]},{name:"layout",path:"assets/models/pavilion/pavilion-layout.json",scale:[.7,.7,.7]}],hotspots:[{name:"ward",position:[1.76,5,5.2],data:{type:"image",url:"https://placekitten.com/1920/1080",caption:"Hello World!"}},{name:"vestible",position:[1.76,5,-4.66],comments:!0,data:{type:"text",url:"https://www.youtube.com/embed/MbDzrNM5qYg",title:"Vestibles",description:"<p>Everyone was infested with head and body lice. But never fear, they had an amazing cure for this: mercury! 18th century Europe had a love affair with mercury. They ate it, they rubbed it on their skin, and then they went batshit crazy and died. On the positive side – at least it killed the lice first!</p><p>Everyone was infested with head and body lice. But never fear, they had an amazing cure for this: mercury! 18th century Europe had a love affair with mercury. They ate it, they rubbed it on their skin, and then they went batshit crazy and died. On the positive side – at least it killed the lice first!</p>"}},{name:"surgery",position:[-9.14,2.52,-9.42],data:{type:"video",url:"https://www.youtube.com/embed/MbDzrNM5qYg"}},{name:"kitchen",position:[5.6,2.18,-10],data:{type:"image",url:"https://placekitten.com/1280/960/",caption:"The PARC Project is exploring antimicrobial resistance and how cross infection is managed in cystic fibrosis clinics, using qualitative methods, including creative visual approaches. It is a multidisciplinary project involving sociologists of medicine and science, an academic architect, micro-biologists and a graphic artist. The research compares the way three outpatient lung infection clinics attempt to control AMR and cross-infection through the design, practices and architectural layout of their built environments. For further information contact Nik Brown (nik.brown@york.ac.uk) or Chrissy Buse (christina.buse@york.ac.uk)."}},{name:"baths",position:[14.28,5,-6.8],data:{type:"text",url:"https://www.youtube.com/embed/MbDzrNM5qYg",title:"18th Century Bathrooms",description:"<p>Everyone was infested with head and body lice. But never fear, they had an amazing cure for this: mercury! 18th century Europe had a love affair with mercury. They ate it, they rubbed it on their skin, and then they went batshit crazy and died. On the positive side – at least it killed the lice first!</p>"}},{name:"porch",position:[1.76,3,15.2],data:{type:"video",url:"https://player.vimeo.com/video/87651855"}},{name:"surgery2",position:[-10.3,3,-6.92],data:{type:"video",url:"https://www.youtube.com/embed/MbDzrNM5qYg"}}]},PAD.Helpers={degRad:function e(t){return t*Math.PI/180},loadModels:function e(t,n){var o=new THREE.ObjectLoader;n.forEach(function(e){o.load(e.path,function(n){n.children.forEach(function(o){var i=new THREE.MeshPhongMaterial({color:16777215,flatShading:!0,side:THREE.DoubleSide});o.material=e.material||i,o.name=e.name,o.castShadow=!0,o.receiveShadow=n.receiveShadow||!1,e.scale&&o.scale.set(e.scale[0],e.scale[1],e.scale[2]),t.add(o)})})})},loadGeometry:function e(t,n){n.forEach(function(e){var n=new THREE.MeshPhongMaterial({color:16777215,flatShading:!0,side:THREE.DoubleSide}),o=new THREE.Mesh(e.geometry,e.material||n);o.position.set(e.position[0],e.position[1],e.position[2]),o.rotation.set(PAD.Helpers.degRad(e.rotation[0]),PAD.Helpers.degRad(e.rotation[1]),PAD.Helpers.degRad(e.rotation[2])),o.name=e.name,o.receiveShadow=e.receiveShadow||!0,o.castShadow=e.castShadow||!1,t.add(o)})}},PAD.Events=function(){function e(e,t){o[e]=o[e]||[],o[e].push(t)}function t(e,t){if(o[e])for(var n=0;n<o[e].length;n++)if(o[e][n]===t){o[e].splice(n,1);break}}function n(e,t){o[e]&&o[e].forEach(function(e){e(t)})}var o={};return{on:e,off:t,emit:n}}(),PAD.Canvas=function(){function e(){document.fullscreenElement?document.exitFullscreen&&document.exitFullscreen():document.documentElement.requestFullscreen()}var t=document.getElementById("stage"),n=t.offsetWidth,o=t.offsetHeight,i=new THREE.Scene,a=new THREE.PerspectiveCamera(45,n/o,.01,1e3),s=new THREE.Color(PAD.Options.bgColor),r=new THREE.Color(PAD.Options.bgColor),c=new THREE.WebGLRenderer,l=new THREE.OrbitControls(a,t),d=function e(){n=t.offsetWidth,o=t.offsetHeight,a.aspect=n/o,a.updateProjectionMatrix(),c.setSize(n,o),PAD.Events.emit("windowResize")},m=function e(){PAD.Events.emit("sceneUpdate")},p=function e(){c.render(i,a),PAD.Events.emit("sceneRender")},u=function e(){requestAnimationFrame(e),m(),p()};return i.background=s,i.name="Scene",PAD.Options.fog&&(i.fog=new THREE.Fog(r,0,2*PAD.Options.maxDistance)),a.position.set(0,0,50),a.name="Camera",l.minDistance=PAD.Options.minDistance,l.maxDistance=PAD.Options.maxDistance,l.maxPolarAngle=PAD.Helpers.degRad(PAD.Options.maxPolarAngle),l.minPolarAngle=PAD.Helpers.degRad(PAD.Options.minPolarAngle),l.enableKeys=!0,l.update(),c.setSize(n,o),c.shadowMap.enabled=!0,c.shadowMapSoft=!0,t.appendChild(c.domElement),window.addEventListener("resize",d,!1),u(),document.getElementById("fullscreen").addEventListener("click",e),{scene:i,camera:a,controls:l,renderer:c,stage:t}}(),PAD.SceneLights=function(e,t){var n=PAD.Options.showLights,o=new THREE.Group,i;o.name="SceneLights";var a=function e(t){var n=new THREE.DirectionalLight(t.color);n.position.set(t.position[0],t.position[1],t.position[2]),n.castShadow=t.shadow,n.name=t.name||null,o.add(n)},s=function e(t){var n=new THREE.AmbientLight(t.color||4210752,t.intensity||1);n.name=t.name||"Ambient",o.add(n)},r=function e(t){var a=new THREE.PointLight(t.color,t.intensity,t.distance||0,t.decay||2);a.position.set(t.position[0],t.position[1],t.position[2]),n&&a.add(new THREE.Mesh(i,new THREE.MeshBasicMaterial({color:t.color}))),a.castShadow=t.shadow,a.name=t.name||"Point"+t.color,o.add(a)},c=function e(t){var n=new THREE.HemisphereLight(t.sky,t.ground,t.intensity||1);n.name=t.name||"Sky",o.add(n)};n&&(i=new THREE.SphereBufferGeometry(.25,16,8)),t.forEach(function(e){switch(e.type){case"Directional":a(e);break;case"Ambient":s(e);break;case"Point":r(e);break;case"Hemisphere":c(e);break;default:break}}),e.add(o)},PAD.Hotspots=function(e,t){var n=PAD.Options.hotspotColor,o=new THREE.ConeBufferGeometry(.4,1.2,16),i=new THREE.Group,a=document.querySelector(".counter span"),s=0,r=function e(t){a.innerHTML=parseInt(a.innerHTML)+t},c=function e(t){r(t)},l=function e(t){r(-t)},d=function e(t){0==t.clicked&&(l(1),t.clicked=!0)},m=function t(){e.rotation.y+=PAD.Helpers.degRad(.07)},p=function e(t){t.scale.set(1.5,1.5,1.5),t.intensity=3*t.intensity,PAD.Media(t),PAD.Events.off("sceneUpdate",m)},u=function e(t){t.scale.set(.3,.3,.3),t.intensity=t.intensity/6,d(t.userData)},h=function e(t){t.scale.set(.3,.3,.3),t.intensity=t.intensity/6,PAD.Events.on("sceneUpdate",m),d(t.userData)};t.forEach(function(t){var a=0,r=.01+.005*s,c=new THREE.PointLight(n,0,2*t.position[1],1),l=new THREE.MeshLambertMaterial({color:n,emissive:n,emissiveIntensity:.6}),d=new THREE.Mesh(o,l);d.rotation.x=PAD.Helpers.degRad(180),c.position.set(t.position[0],t.position[1],t.position[2]),c.add(d),c.castShadow=!0,c.name="hotspot-"+t.name,c.userData=t.data,c.userData.clicked=!1,t.comments&&(c.userData.comments=!0,c.userData.commentID=(e.name+"-"+t.name).toLowerCase()),PAD.Events.on("sceneUpdate",function(){a+=r,d.position.y=Math.sin(a)}),i.add(c),s++}),i.name="hotspots",c(s),e.add(i),PAD.Raycaster(i,e.name),PAD.Events.on("sceneUpdate",m),PAD.Events.on(e.name+"_prevItem",u),PAD.Events.on(e.name+"_newItem",p),PAD.Events.on(e.name+"_noItem",h)},PAD.Raycaster=function(e,t){function n(t){var n=new THREE.Raycaster,o={x:0,y:0},i=new THREE.Vector3,a=PAD.Canvas.camera,s=PAD.Canvas.stage,r=s.getBoundingClientRect(),c=r.top+document.body.scrollTop,l=r.left+document.body.scrollLeft,d=i.clone().unproject(a);return o.x=(t.clientX-l)/s.offsetWidth*2-1,o.y=-((t.clientY-c)/s.offsetHeight*2-1),d.set(o.x,o.y,.5),d.unproject(a),n.set(a.position,d.sub(a.position).normalize()),n.intersectObjects(e.children,!0)}function o(e){e.preventDefault();var o=n(e);if(o.length>0){var a=o[0].object;i==a?PAD.Events.emit(t+"_currentItem",a.parent):i!=a&&(i&&PAD.Events.emit(t+"_prevItem",i.parent),i=a,PAD.Events.emit(t+"_newItem",a.parent))}else i&&PAD.Events.emit(t+"_noItem",i.parent),i=null}var i,a=PAD.Canvas.renderer;PAD.Events.on("sceneRender",function(){a.domElement.addEventListener("click",o),a.domElement.addEventListener("touchend",o)})},PAD.Texture=function(e){var t=PAD.Canvas.scene.getObjectByName("floor");if(null==e||""==e)return t.material.map=null,void(t.material.needsUpdate=!0);var n=document.getElementById("texture"),o=new THREE.VideoTexture(n,THREE.UVMapping);o.minFilter=THREE.LinearFilter,o.magFilter=THREE.LinearFilter,o.format=THREE.RGBFormat,n.src=e,n.play(),t.material.map=o,t.material.needsUpdate=!0},PAD.Media=function(e){function t(){var e=document.getElementById("videoStage"),t=e.querySelector("iframe"),n=e.querySelector(".close");t.src=i.url+"?autoplay=1&portrait=0&controls=0&showinfo=0&rel=1&modestbranding=1",e.classList.remove("hidden"),n.addEventListener("click",function(n){n.preventDefault(),t.src="",e.classList.add("hidden"),PAD.Canvas.renderer.domElement.click()})}function n(){var e=document.getElementById("imageStage"),t=e.querySelector("figure img"),n=e.querySelector("figure figcaption"),o=e.querySelector(".close");t.src=i.url,n.innerHTML=i.caption,e.classList.remove("hidden"),o.addEventListener("click",function(o){o.preventDefault(),t.src="",n.innerHTML="",e.classList.add("hidden"),PAD.Canvas.renderer.domElement.click()})}function o(){document.querySelector(".content").innerHTML="<h1>"+i.title+"</h1>"+i.description,setTimeout(function(){PAD.Canvas.renderer.domElement.click()},2e3)}var i=e.userData;switch(i.type){case"video":t();break;case"image":n();break;case"text":o();break;default:break}PAD.Texture(i.floor)},PAD.Clinics=function(){var e={};for(var t in PAD.Data){var n=PAD.Data[t],o=new THREE.Group;o.name=t,n.models&&PAD.Helpers.loadModels(o,n.models),n.geometry&&PAD.Helpers.loadGeometry(o,n.geometry),n.sceneLights&&PAD.SceneLights(o,n.sceneLights),n.hotspots&&PAD.Hotspots(o,n.hotspots),e[t]=o}return delete PAD.Data,e}(),function(){var e=document.querySelectorAll(".clinic"),t=PAD.Canvas.scene,n;PAD.Clinics.Global&&t.add(PAD.Clinics.Global),e.forEach(function(e){e.addEventListener("click",function(o){o.preventDefault();var i=e.dataset.clinic,a=PAD.Clinics[i],s=t.getObjectByName(n);s!=a&&(s&&t.remove(s),a&&t.add(a),n=i)})}),e[0].click()}();
//# sourceMappingURL=./main.js.map